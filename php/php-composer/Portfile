# -*- coding: utf-8; mode: tcl; tab-width: 4; indent-tabs-mode: nil; c-basic-offset: 4 -*- vim:fenc=utf-8:ft=tcl:et:sw=4:ts=4:sts=4

PortSystem          1.0
PortGroup           php 1.1
PortGroup           github 1.0

github.setup        composer composer 2.5.8
name                php-composer
revision            0
categories-append   devel
platforms           any
license             MIT
maintainers         {ego.team:yet @yugaego} openmaintainer

description         a dependency manager for the PHP programming language

long_description    Composer is {*}${description}. It helps you declare, \
                    manage, and install dependencies of PHP projects.

homepage            https://getcomposer.org

github.tarball_from releases
distname            composer
extract.suffix      .phar

php.branches        5.3 5.4 5.5 5.6 7.0 7.1 7.2 7.3 7.4 8.0 8.1 8.2

if {[vercmp ${php.branch} >= 7.2]} {
    revision            0
    checksums           rmd160  cbcc680e5206a5f016151ab15824685523538819 \
                        sha256  f07934fad44f9048c0dc875a506cca31cc2794d6aebfc1867f3b1fbf48dce2c5 \
                        size    2837394
} else {
    github.setup        composer composer 2.2.21
    revision            0
    checksums           rmd160  d1dfe306215d8f3cbf92558214fcca8893f896e1 \
                        sha256  5211584ad39af26704da9f6209bc5d8104a2d576e80ce9c7ed8368ddd779d0af \
                        size    2384623
}

depends_run    port:${php}-openssl \
               port:${php}-iconv \
               port:${php}-mbstring

# https://trac.macports.org/wiki/PortfileRecipes#fetchnotarball
extract {
    ui_debug "I am in EXTRACT"
    ui_debug "Copy ${distpath}/${distfiles}"
    ui_debug "To ${workpath}/${distname}"
    file copy ${distpath}/${distfiles} ${workpath}/${distname}
}

use_configure no

build {
        ui_debug "I am in BUILD"
}

destroot {
    ui_debug "I am in DESTROOT"
    ui_debug "Copy ${workpath}/${distname}"
    ui_debug "To ${destroot}${prefix}/bin/"
    file copy ${workpath}/${distname} ${destroot}${prefix}/bin/
}

post-destroot {
    ui_debug "I am in POST DESTROOT"
}

post-install {}
